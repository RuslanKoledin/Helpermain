# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤–∏–¥–µ–æ

## üîç –ü—Ä–æ–±–ª–µ–º–∞

**–ù–∞–π–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:**
```
[get_file_url] Telegram API error: A request to the Telegram API was unsuccessful.
Error code: 400. Description: Bad Request: file is too big
```

**–ü—Ä–∏—á–∏–Ω–∞:** Telegram Bot API –º–µ—Ç–æ–¥ `getFile` —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –¥–æ 20 –ú–ë**. –í–∞—à–µ –≤–∏–¥–µ–æ –≤–µ—Å–∏–ª–æ 42 –ú–ë.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω –ø—Ä–æ–∫—Å–∏-—Ä–æ—É—Ç –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –≤–∏–¥–µ–æ

**–§–∞–π–ª:** `helper7.py`, —Å—Ç—Ä–æ–∫–∞ 841-911

–ù–æ–≤—ã–π —Ä–æ—É—Ç `/stream_video/<file_id>`:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º–æ–π HTTP –∑–∞–ø—Ä–æ—Å –∫ Telegram API
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∞–π–ª—ã **–¥–æ 100 –ú–ë**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ç–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–¥–∞—á—É (streaming) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Range requests –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–æ—Ç–∫–∏ –≤–∏–¥–µ–æ

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `show_manual`

**–§–∞–π–ª:** `helper7.py`, —Å—Ç—Ä–æ–∫–∞ 805-821

–¢–µ–ø–µ—Ä—å –≤–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ `get_file_url()` —Å–æ–∑–¥–∞–µ—Ç—Å—è URL –¥–ª—è –ø—Ä–æ–∫—Å–∏-—Ä–æ—É—Ç–∞:
```python
video_url = url_for('stream_video', file_id=video_id)
```

### 3. –£–≤–µ–ª–∏—á–µ–Ω—ã –ª–∏–º–∏—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏

#### Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- `app.config['MAX_CONTENT_LENGTH']` = **100 –ú–ë** (—Å—Ç—Ä–æ–∫–∞ 104)

#### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:
- `max_file_size` = **100 –ú–ë** (—Å—Ç—Ä–æ–∫–∞ 1729)
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (—Å—Ç—Ä–æ–∫–∏ 1747, 1756)

#### –®–∞–±–ª–æ–Ω –∑–∞–≥—Ä—É–∑–∫–∏:
- `templates/admin_upload_video.html` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ª–∏–º–∏—Ç—ã –¥–æ 100 –ú–ë

## üìã –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ü—Ä–µ–∂–Ω—è—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ù–ï —Ä–∞–±–æ—Ç–∞–ª–∞):
```
Browser ‚Üí Flask ‚Üí bot.get_file(file_id) ‚Üí ‚ùå Error: file > 20MB
                ‚Üí get_file_url() ‚Üí None
                ‚Üí video_data = None
                ‚Üí –í–∏–¥–µ–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
```

### –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–†–ê–ë–û–¢–ê–ï–¢):
```
Browser ‚Üí Flask ‚Üí url_for('stream_video', file_id)
        ‚Üí video_data = {url: '/stream_video/BAC...'}
        ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTML —Å <video src="/stream_video/BAC...">

Browser –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ:
        ‚Üí GET /stream_video/BAC...
        ‚Üí Flask –¥–µ–ª–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å –∫ Telegram API
        ‚Üí –ü–æ–ª—É—á–∞–µ—Ç file_path —á–µ—Ä–µ–∑ getFile API
        ‚Üí –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª —Å https://api.telegram.org/file/bot.../
        ‚Üí –°—Ç—Ä–∏–º–∏—Ç –≤–∏–¥–µ–æ –≤ –±—Ä–∞—É–∑–µ—Ä (chunk –ø–æ 8KB)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∏–¥–µ–æ:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python3 helper7.py

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
# http://localhost:5003
# ‚Üí –ú–∞–Ω—É–∞–ª—ã –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
# ‚Üí 1. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—á—Ç–æ–π
# ‚Üí 1.1 –ó–∞–ø–æ–ª–Ω–∏–ª–∞—Å—å –ø–∞–º—è—Ç—å (–∏–ª–∏ 1.2, 1.3)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```
[show_manual] Found video in subproblem_data, video_id: BAACAgI...
[show_manual] Created video_data with proxy URL: /stream_video/BAACAgI...
[show_manual] Rendering template with:
  - manual_title: –ó–∞–ø–æ–ª–Ω–∏–ª–∞—Å—å –ø–∞–º—è—Ç—å
  - video_data: Present
  - photos count: 6
```

**–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∏–¥–µ–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```
[stream_video] Streaming video file_id: BAACAgI...
[stream_video] Downloading from: https://api.telegram.org/file/bot...
[stream_video] Streaming video, size: 44123456 bytes
```

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ –¥–æ 100 –ú–ë:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É: http://localhost:5003/admin/login
2. Dashboard ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –º–∞–Ω—É–∞–ª ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–ø—Ä–æ–±–ª–µ–º—É
3. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ"
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –¥–æ 100 –ú–ë
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏** —á—Ç–æ –≤–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram.

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ –º–∞–Ω—É–∞–ª –∏ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- ‚úÖ –í–∏–¥–µ–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –í–∏–¥–µ–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–º–æ—Ç–∞—Ç—å –≤–∏–¥–µ–æ
- ‚úÖ –ü–æ—Å–ª–µ –≤–∏–¥–µ–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–ø—Ä–æ—Å "–ü–æ–º–æ–≥–ª–æ –ª–∏ –≤–∏–¥–µ–æ?"

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram Bot API:
- Telegram –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å —Ñ–∞–π–ª—ã –¥–æ **100 –ú–ë** —á–µ—Ä–µ–∑ Bot API
- –î–ª—è —Ñ–∞–π–ª–æ–≤ **–±–æ–ª—å—à–µ 100 –ú–ë** –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Client API (–Ω–µ Bot API)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞:

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ nginx –ø–µ—Ä–µ–¥ Flask, –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```nginx
# –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
client_max_body_size 100M;

# –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
proxy_read_timeout 300;
proxy_connect_timeout 300;
proxy_send_timeout 300;
```

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Apache:

```apache
LimitRequestBody 104857600
Timeout 300
```

### –®–∏—Ä–∏–Ω–∞ –≤–∏–¥–µ–æ:

**–®–∏—Ä–∏–Ω–∞ –∫–∞–¥—Ä–∞ –ù–ï –≤–∞–∂–Ω–∞!** –í CSS –µ—Å—Ç—å:
```css
video {
    max-width: 100%;
    border-radius: 12px;
}
```

–í–∏–¥–µ–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞.

## üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –í–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (spinning wheel)

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ Flask:**
```
[stream_video] Telegram API error: ...
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- BOT_TOKEN –Ω–µ–≤–µ—Ä–Ω—ã–π
- file_id —É—Å—Ç–∞—Ä–µ–ª (—Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω –∏–∑ Telegram)
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Telegram API

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ 413 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –í–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx/Apache) –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã

**–†–µ—à–µ–Ω–∏–µ:** –°–º. —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞" –≤—ã—à–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –í–∏–¥–µ–æ —Ç–æ—Ä–º–æ–∑–∏—Ç –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram API

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- Telegram API –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ –ª–æ–∫–∞–ª—å–Ω–æ (advanced)

## üìù –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. ‚úÖ `helper7.py` - –¥–æ–±–∞–≤–ª–µ–Ω —Ä–æ—É—Ç `/stream_video`, –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ª–∏–º–∏—Ç—ã, —É–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
2. ‚úÖ `templates/admin_upload_video.html` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ª–∏–º–∏—Ç—ã –¥–æ 100 –ú–ë
3. ‚úÖ `test_video_display.py` - —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
4. ‚úÖ –≠—Ç–æ—Ç —Ñ–∞–π–ª - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∏–¥–µ–æ
2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ** —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä** –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ nginx/Apache (–¥–ª—è production)
5. **–£–¥–∞–ª–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –≤–∏–¥–µ–æ –¥–æ 100 –ú–ë –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ
